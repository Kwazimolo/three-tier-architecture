{"check_type": "cloudformation", "results": {"passed_checks": [{"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": [[21, "  BastionSecurityGroup:\n"], [22, "    Type: AWS::EC2::SecurityGroup\n"], [23, "    Properties:\n"], [24, "      GroupDescription: Security group for Bastion Host on the presentation tier\n"], [25, "      VpcId: !Ref VpcId\n"], [26, "      SecurityGroupIngress:\n"], [27, "        - IpProtocol: tcp\n"], [28, "          FromPort: 22\n"], [29, "          ToPort: 22\n"], [30, "          CidrIp: !Ref BastionCidrIP\n"], [31, "          Description: SSH into the instance\n"], [32, "      SecurityGroupEgress:\n"], [33, "        - IpProtocol: -1\n"], [34, "          FromPort: 0\n"], [35, "          ToPort: 0\n"], [36, "          CidrIp: 0.0.0.0/0\n"], [37, "          Description: Allow Outbound connectivity\n"], [38, "      Tags:\n"], [39, "        - Key: Name\n"], [40, "          Value: CF-bastion-sg\n"], [41, "        - Key: Environment\n"], [42, "          Value: !Ref EnvironmentName\n"], [43, "        - Key: ManagedBy\n"], [44, "          Value: CloudFormation\n"], [45, "        - Key: Tier\n"], [46, "          Value: Presentation\n"], [47, "        - Key: Role\n"], [48, "          Value: Bastion\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [21, 48], "resource": "AWS::EC2::SecurityGroup.BastionSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "CF-bastion-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Presentation", "Role": "Bastion"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"SecurityGroupIngress.0.CidrIp": [{"type": "parameters", "name": "BastionCidrIP", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "SecurityGroupIngress.0": [{"type": "parameters", "name": "BastionCidrIP", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": [[21, "  BastionSecurityGroup:\n"], [22, "    Type: AWS::EC2::SecurityGroup\n"], [23, "    Properties:\n"], [24, "      GroupDescription: Security group for Bastion Host on the presentation tier\n"], [25, "      VpcId: !Ref VpcId\n"], [26, "      SecurityGroupIngress:\n"], [27, "        - IpProtocol: tcp\n"], [28, "          FromPort: 22\n"], [29, "          ToPort: 22\n"], [30, "          CidrIp: !Ref BastionCidrIP\n"], [31, "          Description: SSH into the instance\n"], [32, "      SecurityGroupEgress:\n"], [33, "        - IpProtocol: -1\n"], [34, "          FromPort: 0\n"], [35, "          ToPort: 0\n"], [36, "          CidrIp: 0.0.0.0/0\n"], [37, "          Description: Allow Outbound connectivity\n"], [38, "      Tags:\n"], [39, "        - Key: Name\n"], [40, "          Value: CF-bastion-sg\n"], [41, "        - Key: Environment\n"], [42, "          Value: !Ref EnvironmentName\n"], [43, "        - Key: ManagedBy\n"], [44, "          Value: CloudFormation\n"], [45, "        - Key: Tier\n"], [46, "          Value: Presentation\n"], [47, "        - Key: Role\n"], [48, "          Value: Bastion\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [21, 48], "resource": "AWS::EC2::SecurityGroup.BastionSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "CF-bastion-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Presentation", "Role": "Bastion"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"SecurityGroupIngress.0.CidrIp": [{"type": "parameters", "name": "BastionCidrIP", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "SecurityGroupIngress.0": [{"type": "parameters", "name": "BastionCidrIP", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security groups rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties"]}, "code_block": [[21, "  BastionSecurityGroup:\n"], [22, "    Type: AWS::EC2::SecurityGroup\n"], [23, "    Properties:\n"], [24, "      GroupDescription: Security group for Bastion Host on the presentation tier\n"], [25, "      VpcId: !Ref VpcId\n"], [26, "      SecurityGroupIngress:\n"], [27, "        - IpProtocol: tcp\n"], [28, "          FromPort: 22\n"], [29, "          ToPort: 22\n"], [30, "          CidrIp: !Ref BastionCidrIP\n"], [31, "          Description: SSH into the instance\n"], [32, "      SecurityGroupEgress:\n"], [33, "        - IpProtocol: -1\n"], [34, "          FromPort: 0\n"], [35, "          ToPort: 0\n"], [36, "          CidrIp: 0.0.0.0/0\n"], [37, "          Description: Allow Outbound connectivity\n"], [38, "      Tags:\n"], [39, "        - Key: Name\n"], [40, "          Value: CF-bastion-sg\n"], [41, "        - Key: Environment\n"], [42, "          Value: !Ref EnvironmentName\n"], [43, "        - Key: ManagedBy\n"], [44, "          Value: CloudFormation\n"], [45, "        - Key: Tier\n"], [46, "          Value: Presentation\n"], [47, "        - Key: Role\n"], [48, "          Value: Bastion\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [21, 48], "resource": "AWS::EC2::SecurityGroup.BastionSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "CF-bastion-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Presentation", "Role": "Bastion"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"SecurityGroupIngress.0.CidrIp": [{"type": "parameters", "name": "BastionCidrIP", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "SecurityGroupIngress.0": [{"type": "parameters", "name": "BastionCidrIP", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": [[51, "  AlbSecurityGroup:\n"], [52, "    Type: AWS::EC2::SecurityGroup\n"], [53, "    Properties:\n"], [54, "      GroupDescription: Security group for load balancer on the web tier\n"], [55, "      VpcId: !Ref VpcId\n"], [56, "      SecurityGroupIngress:\n"], [57, "        - IpProtocol: tcp\n"], [58, "          FromPort: 80\n"], [59, "          ToPort: 80\n"], [60, "          CidrIp: 0.0.0.0/0\n"], [61, "          Description: Access to webpage\n"], [62, "      SecurityGroupEgress:\n"], [63, "        - IpProtocol: -1\n"], [64, "          FromPort: 0\n"], [65, "          ToPort: 0\n"], [66, "          CidrIp: 0.0.0.0/0\n"], [67, "          Description: Allow all Outbound connectivity\n"], [68, "      Tags:\n"], [69, "        - Key: Name\n"], [70, "          Value: CF-alb-sg\n"], [71, "        - Key: Environment\n"], [72, "          Value: !Ref EnvironmentName\n"], [73, "        - Key: ManagedBy\n"], [74, "          Value: CloudFormation\n"], [75, "        - Key: Tier\n"], [76, "          Value: Web\n"], [77, "        - Key: Role\n"], [78, "          Value: LoadBalancer\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [51, 78], "resource": "AWS::EC2::SecurityGroup.AlbSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "CF-alb-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Web", "Role": "LoadBalancer"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": [[51, "  AlbSecurityGroup:\n"], [52, "    Type: AWS::EC2::SecurityGroup\n"], [53, "    Properties:\n"], [54, "      GroupDescription: Security group for load balancer on the web tier\n"], [55, "      VpcId: !Ref VpcId\n"], [56, "      SecurityGroupIngress:\n"], [57, "        - IpProtocol: tcp\n"], [58, "          FromPort: 80\n"], [59, "          ToPort: 80\n"], [60, "          CidrIp: 0.0.0.0/0\n"], [61, "          Description: Access to webpage\n"], [62, "      SecurityGroupEgress:\n"], [63, "        - IpProtocol: -1\n"], [64, "          FromPort: 0\n"], [65, "          ToPort: 0\n"], [66, "          CidrIp: 0.0.0.0/0\n"], [67, "          Description: Allow all Outbound connectivity\n"], [68, "      Tags:\n"], [69, "        - Key: Name\n"], [70, "          Value: CF-alb-sg\n"], [71, "        - Key: Environment\n"], [72, "          Value: !Ref EnvironmentName\n"], [73, "        - Key: ManagedBy\n"], [74, "          Value: CloudFormation\n"], [75, "        - Key: Tier\n"], [76, "          Value: Web\n"], [77, "        - Key: Role\n"], [78, "          Value: LoadBalancer\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [51, 78], "resource": "AWS::EC2::SecurityGroup.AlbSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "CF-alb-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Web", "Role": "LoadBalancer"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security groups rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties"]}, "code_block": [[51, "  AlbSecurityGroup:\n"], [52, "    Type: AWS::EC2::SecurityGroup\n"], [53, "    Properties:\n"], [54, "      GroupDescription: Security group for load balancer on the web tier\n"], [55, "      VpcId: !Ref VpcId\n"], [56, "      SecurityGroupIngress:\n"], [57, "        - IpProtocol: tcp\n"], [58, "          FromPort: 80\n"], [59, "          ToPort: 80\n"], [60, "          CidrIp: 0.0.0.0/0\n"], [61, "          Description: Access to webpage\n"], [62, "      SecurityGroupEgress:\n"], [63, "        - IpProtocol: -1\n"], [64, "          FromPort: 0\n"], [65, "          ToPort: 0\n"], [66, "          CidrIp: 0.0.0.0/0\n"], [67, "          Description: Allow all Outbound connectivity\n"], [68, "      Tags:\n"], [69, "        - Key: Name\n"], [70, "          Value: CF-alb-sg\n"], [71, "        - Key: Environment\n"], [72, "          Value: !Ref EnvironmentName\n"], [73, "        - Key: ManagedBy\n"], [74, "          Value: CloudFormation\n"], [75, "        - Key: Tier\n"], [76, "          Value: Web\n"], [77, "        - Key: Role\n"], [78, "          Value: LoadBalancer\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [51, 78], "resource": "AWS::EC2::SecurityGroup.AlbSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "CF-alb-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Web", "Role": "LoadBalancer"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": [[81, "  AppSecurityGroup:\n"], [82, "    Type: AWS::EC2::SecurityGroup\n"], [83, "    Properties:\n"], [84, "      GroupDescription: Security group for application servers on the application tier\n"], [85, "      VpcId: !Ref VpcId\n"], [86, "      SecurityGroupIngress:\n"], [87, "        - IpProtocol: tcp\n"], [88, "          FromPort: 22\n"], [89, "          ToPort: 22\n"], [90, "          SourceSecurityGroupId: !Ref BastionSecurityGroup\n"], [91, "          Description: SSH into the instance from bastion host\n"], [92, "      SecurityGroupEgress:\n"], [93, "        - IpProtocol: -1\n"], [94, "          FromPort: 0\n"], [95, "          ToPort: 0\n"], [96, "          CidrIp: 0.0.0.0/0\n"], [97, "          Description: Allow Outbound connectivity\n"], [98, "      Tags:\n"], [99, "        - Key: Name\n"], [100, "          Value: CF-app-sg\n"], [101, "        - Key: Environment\n"], [102, "          Value: !Ref EnvironmentName\n"], [103, "        - Key: ManagedBy\n"], [104, "          Value: CloudFormation\n"], [105, "        - Key: Tier\n"], [106, "          Value: Application\n"], [107, "        - Key: Role\n"], [108, "          Value: WebServer\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [81, 108], "resource": "AWS::EC2::SecurityGroup.AppSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "CF-app-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Application", "Role": "WebServer"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": [[81, "  AppSecurityGroup:\n"], [82, "    Type: AWS::EC2::SecurityGroup\n"], [83, "    Properties:\n"], [84, "      GroupDescription: Security group for application servers on the application tier\n"], [85, "      VpcId: !Ref VpcId\n"], [86, "      SecurityGroupIngress:\n"], [87, "        - IpProtocol: tcp\n"], [88, "          FromPort: 22\n"], [89, "          ToPort: 22\n"], [90, "          SourceSecurityGroupId: !Ref BastionSecurityGroup\n"], [91, "          Description: SSH into the instance from bastion host\n"], [92, "      SecurityGroupEgress:\n"], [93, "        - IpProtocol: -1\n"], [94, "          FromPort: 0\n"], [95, "          ToPort: 0\n"], [96, "          CidrIp: 0.0.0.0/0\n"], [97, "          Description: Allow Outbound connectivity\n"], [98, "      Tags:\n"], [99, "        - Key: Name\n"], [100, "          Value: CF-app-sg\n"], [101, "        - Key: Environment\n"], [102, "          Value: !Ref EnvironmentName\n"], [103, "        - Key: ManagedBy\n"], [104, "          Value: CloudFormation\n"], [105, "        - Key: Tier\n"], [106, "          Value: Application\n"], [107, "        - Key: Role\n"], [108, "          Value: WebServer\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [81, 108], "resource": "AWS::EC2::SecurityGroup.AppSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "CF-app-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Application", "Role": "WebServer"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security groups rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties"]}, "code_block": [[81, "  AppSecurityGroup:\n"], [82, "    Type: AWS::EC2::SecurityGroup\n"], [83, "    Properties:\n"], [84, "      GroupDescription: Security group for application servers on the application tier\n"], [85, "      VpcId: !Ref VpcId\n"], [86, "      SecurityGroupIngress:\n"], [87, "        - IpProtocol: tcp\n"], [88, "          FromPort: 22\n"], [89, "          ToPort: 22\n"], [90, "          SourceSecurityGroupId: !Ref BastionSecurityGroup\n"], [91, "          Description: SSH into the instance from bastion host\n"], [92, "      SecurityGroupEgress:\n"], [93, "        - IpProtocol: -1\n"], [94, "          FromPort: 0\n"], [95, "          ToPort: 0\n"], [96, "          CidrIp: 0.0.0.0/0\n"], [97, "          Description: Allow Outbound connectivity\n"], [98, "      Tags:\n"], [99, "        - Key: Name\n"], [100, "          Value: CF-app-sg\n"], [101, "        - Key: Environment\n"], [102, "          Value: !Ref EnvironmentName\n"], [103, "        - Key: ManagedBy\n"], [104, "          Value: CloudFormation\n"], [105, "        - Key: Tier\n"], [106, "          Value: Application\n"], [107, "        - Key: Role\n"], [108, "          Value: WebServer\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [81, 108], "resource": "AWS::EC2::SecurityGroup.AppSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "CF-app-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Application", "Role": "WebServer"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties"]}, "code_block": [[111, "  AppSecurityGroupIngressFromALB:\n"], [112, "    Type: AWS::EC2::SecurityGroupIngress\n"], [113, "    Properties:\n"], [114, "      GroupId: !Ref AppSecurityGroup\n"], [115, "      IpProtocol: tcp\n"], [116, "      FromPort: 80\n"], [117, "      ToPort: 80\n"], [118, "      SourceSecurityGroupId: !Ref AlbSecurityGroup\n"], [119, "      Description: Allow connectivity from ALB\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [111, 119], "resource": "AWS::EC2::SecurityGroupIngress.AppSecurityGroupIngressFromALB", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties"]}, "code_block": [[111, "  AppSecurityGroupIngressFromALB:\n"], [112, "    Type: AWS::EC2::SecurityGroupIngress\n"], [113, "    Properties:\n"], [114, "      GroupId: !Ref AppSecurityGroup\n"], [115, "      IpProtocol: tcp\n"], [116, "      FromPort: 80\n"], [117, "      ToPort: 80\n"], [118, "      SourceSecurityGroupId: !Ref AlbSecurityGroup\n"], [119, "      Description: Allow connectivity from ALB\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [111, 119], "resource": "AWS::EC2::SecurityGroupIngress.AppSecurityGroupIngressFromALB", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security groups rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[111, "  AppSecurityGroupIngressFromALB:\n"], [112, "    Type: AWS::EC2::SecurityGroupIngress\n"], [113, "    Properties:\n"], [114, "      GroupId: !Ref AppSecurityGroup\n"], [115, "      IpProtocol: tcp\n"], [116, "      FromPort: 80\n"], [117, "      ToPort: 80\n"], [118, "      SourceSecurityGroupId: !Ref AlbSecurityGroup\n"], [119, "      Description: Allow connectivity from ALB\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [111, 119], "resource": "AWS::EC2::SecurityGroupIngress.AppSecurityGroupIngressFromALB", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": [[122, "  DbSecurityGroup:\n"], [123, "    Type: AWS::EC2::SecurityGroup\n"], [124, "    Properties:\n"], [125, "      GroupDescription: Allow application tier to communicate to database tier\n"], [126, "      VpcId: !Ref VpcId\n"], [127, "      SecurityGroupIngress:\n"], [128, "        - IpProtocol: tcp\n"], [129, "          FromPort: 3306\n"], [130, "          ToPort: 3306\n"], [131, "          SourceSecurityGroupId: !Ref AppSecurityGroup\n"], [132, "          Description: Allow connection to database\n"], [133, "      Tags:\n"], [134, "        - Key: Name\n"], [135, "          Value: CF-db-sg\n"], [136, "        - Key: Environment\n"], [137, "          Value: !Ref EnvironmentName\n"], [138, "        - Key: ManagedBy\n"], [139, "          Value: CloudFormation\n"], [140, "        - Key: Tier\n"], [141, "          Value: Data\n"], [142, "        - Key: Role\n"], [143, "          Value: Database\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [122, 143], "resource": "AWS::EC2::SecurityGroup.DbSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "CF-db-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Data", "Role": "Database"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": [[122, "  DbSecurityGroup:\n"], [123, "    Type: AWS::EC2::SecurityGroup\n"], [124, "    Properties:\n"], [125, "      GroupDescription: Allow application tier to communicate to database tier\n"], [126, "      VpcId: !Ref VpcId\n"], [127, "      SecurityGroupIngress:\n"], [128, "        - IpProtocol: tcp\n"], [129, "          FromPort: 3306\n"], [130, "          ToPort: 3306\n"], [131, "          SourceSecurityGroupId: !Ref AppSecurityGroup\n"], [132, "          Description: Allow connection to database\n"], [133, "      Tags:\n"], [134, "        - Key: Name\n"], [135, "          Value: CF-db-sg\n"], [136, "        - Key: Environment\n"], [137, "          Value: !Ref EnvironmentName\n"], [138, "        - Key: ManagedBy\n"], [139, "          Value: CloudFormation\n"], [140, "        - Key: Tier\n"], [141, "          Value: Data\n"], [142, "        - Key: Role\n"], [143, "          Value: Database\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [122, 143], "resource": "AWS::EC2::SecurityGroup.DbSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "CF-db-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Data", "Role": "Database"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security groups rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties"]}, "code_block": [[122, "  DbSecurityGroup:\n"], [123, "    Type: AWS::EC2::SecurityGroup\n"], [124, "    Properties:\n"], [125, "      GroupDescription: Allow application tier to communicate to database tier\n"], [126, "      VpcId: !Ref VpcId\n"], [127, "      SecurityGroupIngress:\n"], [128, "        - IpProtocol: tcp\n"], [129, "          FromPort: 3306\n"], [130, "          ToPort: 3306\n"], [131, "          SourceSecurityGroupId: !Ref AppSecurityGroup\n"], [132, "          Description: Allow connection to database\n"], [133, "      Tags:\n"], [134, "        - Key: Name\n"], [135, "          Value: CF-db-sg\n"], [136, "        - Key: Environment\n"], [137, "          Value: !Ref EnvironmentName\n"], [138, "        - Key: ManagedBy\n"], [139, "          Value: CloudFormation\n"], [140, "        - Key: Tier\n"], [141, "          Value: Data\n"], [142, "        - Key: Role\n"], [143, "          Value: Database\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [122, 143], "resource": "AWS::EC2::SecurityGroup.DbSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "CF-db-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Data", "Role": "Database"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": [[146, "  VpcEndpointSecurityGroup:\n"], [147, "    Type: AWS::EC2::SecurityGroup\n"], [148, "    Properties:\n"], [149, "      GroupDescription: Security group for VPC endpoints\n"], [150, "      VpcId: !Ref VpcId\n"], [151, "      SecurityGroupIngress:\n"], [152, "        - IpProtocol: tcp\n"], [153, "          FromPort: 443\n"], [154, "          ToPort: 443\n"], [155, "          SourceSecurityGroupId: !Ref AppSecurityGroup\n"], [156, "          Description: Allow HTTPS from EC2 instances\n"], [157, "      Tags:\n"], [158, "        - Key: Name\n"], [159, "          Value: CF-vnet-sg\n"], [160, "        - Key: Environment\n"], [161, "          Value: !Ref EnvironmentName\n"], [162, "        - Key: ManagedBy\n"], [163, "          Value: CloudFormation\n"], [164, "        - Key: Tier\n"], [165, "          Value: Network\n"], [166, "        - Key: Role\n"], [167, "          Value: VPCEndpoint\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [146, 167], "resource": "AWS::EC2::SecurityGroup.VpcEndpointSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "CF-vnet-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Network", "Role": "VPCEndpoint"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SecurityGroupIngress"]}, "code_block": [[146, "  VpcEndpointSecurityGroup:\n"], [147, "    Type: AWS::EC2::SecurityGroup\n"], [148, "    Properties:\n"], [149, "      GroupDescription: Security group for VPC endpoints\n"], [150, "      VpcId: !Ref VpcId\n"], [151, "      SecurityGroupIngress:\n"], [152, "        - IpProtocol: tcp\n"], [153, "          FromPort: 443\n"], [154, "          ToPort: 443\n"], [155, "          SourceSecurityGroupId: !Ref AppSecurityGroup\n"], [156, "          Description: Allow HTTPS from EC2 instances\n"], [157, "      Tags:\n"], [158, "        - Key: Name\n"], [159, "          Value: CF-vnet-sg\n"], [160, "        - Key: Environment\n"], [161, "          Value: !Ref EnvironmentName\n"], [162, "        - Key: ManagedBy\n"], [163, "          Value: CloudFormation\n"], [164, "        - Key: Tier\n"], [165, "          Value: Network\n"], [166, "        - Key: Role\n"], [167, "          Value: VPCEndpoint\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [146, 167], "resource": "AWS::EC2::SecurityGroup.VpcEndpointSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "CF-vnet-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Network", "Role": "VPCEndpoint"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security groups rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties"]}, "code_block": [[146, "  VpcEndpointSecurityGroup:\n"], [147, "    Type: AWS::EC2::SecurityGroup\n"], [148, "    Properties:\n"], [149, "      GroupDescription: Security group for VPC endpoints\n"], [150, "      VpcId: !Ref VpcId\n"], [151, "      SecurityGroupIngress:\n"], [152, "        - IpProtocol: tcp\n"], [153, "          FromPort: 443\n"], [154, "          ToPort: 443\n"], [155, "          SourceSecurityGroupId: !Ref AppSecurityGroup\n"], [156, "          Description: Allow HTTPS from EC2 instances\n"], [157, "      Tags:\n"], [158, "        - Key: Name\n"], [159, "          Value: CF-vnet-sg\n"], [160, "        - Key: Environment\n"], [161, "          Value: !Ref EnvironmentName\n"], [162, "        - Key: ManagedBy\n"], [163, "          Value: CloudFormation\n"], [164, "        - Key: Tier\n"], [165, "          Value: Network\n"], [166, "        - Key: Role\n"], [167, "          Value: VPCEndpoint\n"]], "file_path": "/templates/security.yml", "file_abs_path": "infrastructure/cloudformation/templates/security.yml", "repo_file_path": "/infrastructure/cloudformation/templates/security.yml", "file_line_range": [146, 167], "resource": "AWS::EC2::SecurityGroup.VpcEndpointSecurityGroup", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "CF-vnet-sg", "Environment": "Development", "ManagedBy": "CloudFormation", "Tier": "Network", "Role": "VPCEndpoint"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Tags.1.Value": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}], "Tags.1": [{"type": "parameters", "name": "EnvironmentName", "path": "infrastructure/cloudformation/templates/security.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_16", "bc_check_id": "BC_AWS_GENERAL_4", "check_name": "Ensure all data stored in the RDS is securely encrypted at rest", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/StorageEncrypted"]}, "code_block": [[64, "  PrimaryDBInstance:\n"], [65, "    Type: AWS::RDS::DBInstance\n"], [66, "    Properties:\n"], [67, "      AllocatedStorage: 20\n"], [68, "      DBName: !Ref DbName\n"], [69, "      Engine: !Ref DbEngine\n"], [70, "      EngineVersion: !Ref DbEngineVersion\n"], [71, "      DBInstanceClass: !Ref DbInstanceClass\n"], [72, "      MasterUsername: !Ref DbAdminUsername\n"], [73, "      MasterUserPassword: !Ref DbAdminPassword\n"], [74, "      DBSubnetGroupName: !Ref DatabaseSubnetGroup\n"], [75, "      VPCSecurityGroups: \n"], [76, "        - !Ref DbSecurityGroupId\n"], [77, "      MultiAZ: false\n"], [78, "      PubliclyAccessible: false\n"], [79, "      StorageType: gp2\n"], [80, "      StorageEncrypted: true\n"], [81, "      BackupRetentionPeriod: 7\n"], [82, "      Tags:\n"], [83, "        - Key: Name\n"], [84, "          Value: CF-Data-Tier-DB\n"], [85, "        - Key: Environment\n"], [86, "          Value: Production\n"]], "file_path": "/templates/database.yml", "file_abs_path": "infrastructure/cloudformation/templates/database.yml", "repo_file_path": "/infrastructure/cloudformation/templates/database.yml", "file_line_range": [64, 86], "resource": "AWS::RDS::DBInstance.PrimaryDBInstance", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.RDSEncryption", "fixed_definition": null, "entity_tags": {"Name": "CF-Data-Tier-DB", "Environment": "Production"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"DBInstanceClass": [{"type": "parameters", "name": "DbInstanceClass", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}], "Engine": [{"type": "parameters", "name": "DbEngine", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}], "EngineVersion": [{"type": "parameters", "name": "DbEngineVersion", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}], "DBName": [{"type": "parameters", "name": "DbName", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}], "MasterUsername": [{"type": "parameters", "name": "DbAdminUsername", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}], "MasterUserPassword": [{"type": "parameters", "name": "DbAdminPassword", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_17", "bc_check_id": "BC_AWS_PUBLIC_2", "check_name": "Ensure all data stored in RDS is not publicly accessible", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/PubliclyAccessible"]}, "code_block": [[64, "  PrimaryDBInstance:\n"], [65, "    Type: AWS::RDS::DBInstance\n"], [66, "    Properties:\n"], [67, "      AllocatedStorage: 20\n"], [68, "      DBName: !Ref DbName\n"], [69, "      Engine: !Ref DbEngine\n"], [70, "      EngineVersion: !Ref DbEngineVersion\n"], [71, "      DBInstanceClass: !Ref DbInstanceClass\n"], [72, "      MasterUsername: !Ref DbAdminUsername\n"], [73, "      MasterUserPassword: !Ref DbAdminPassword\n"], [74, "      DBSubnetGroupName: !Ref DatabaseSubnetGroup\n"], [75, "      VPCSecurityGroups: \n"], [76, "        - !Ref DbSecurityGroupId\n"], [77, "      MultiAZ: false\n"], [78, "      PubliclyAccessible: false\n"], [79, "      StorageType: gp2\n"], [80, "      StorageEncrypted: true\n"], [81, "      BackupRetentionPeriod: 7\n"], [82, "      Tags:\n"], [83, "        - Key: Name\n"], [84, "          Value: CF-Data-Tier-DB\n"], [85, "        - Key: Environment\n"], [86, "          Value: Production\n"]], "file_path": "/templates/database.yml", "file_abs_path": "infrastructure/cloudformation/templates/database.yml", "repo_file_path": "/infrastructure/cloudformation/templates/database.yml", "file_line_range": [64, 86], "resource": "AWS::RDS::DBInstance.PrimaryDBInstance", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.RDSPubliclyAccessible", "fixed_definition": null, "entity_tags": {"Name": "CF-Data-Tier-DB", "Environment": "Production"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-2", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"DBInstanceClass": [{"type": "parameters", "name": "DbInstanceClass", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}], "Engine": [{"type": "parameters", "name": "DbEngine", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}], "EngineVersion": [{"type": "parameters", "name": "DbEngineVersion", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}], "DBName": [{"type": "parameters", "name": "DbName", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}], "MasterUsername": [{"type": "parameters", "name": "DbAdminUsername", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}], "MasterUserPassword": [{"type": "parameters", "name": "DbAdminPassword", "path": "infrastructure/cloudformation/templates/database.yml", "attribute_key": "Default"}]}}], "failed_checks": [{"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/Protocol", "Properties/DefaultActions"]}, "code_block": [[89, "  AppListener:\n"], [90, "    Type: AWS::ElasticLoadBalancingV2::Listener\n"], [91, "    Properties:\n"], [92, "      DefaultActions:\n"], [93, "        - Type: forward\n"], [94, "          TargetGroupArn: !Ref AppTargetGroup\n"], [95, "      LoadBalancerArn: !Ref ApplicationLoadBalancer\n"], [96, "      Port: 80\n"], [97, "      Protocol: HTTP\n"], [98, "      Tags:\n"], [99, "        - Key: Name\n"], [100, "          Value: CF-App-Tier-HTTP-Listener\n"], [101, "        - Key: Environment\n"], [102, "          Value: Production\n"], [103, "        - Key: Tier\n"], [104, "          Value: Web\n"], [105, "        - Key: ManagedBy\n"], [106, "          Value: CloudFormation\n"]], "file_path": "/templates/loadbalancing.yml", "file_abs_path": "infrastructure/cloudformation/templates/loadbalancing.yml", "repo_file_path": "/infrastructure/cloudformation/templates/loadbalancing.yml", "file_line_range": [89, 106], "resource": "AWS::ElasticLoadBalancingV2::Listener.AppListener", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": {"Name": "CF-App-Tier-HTTP-Listener", "Environment": "Production", "Tier": "Web", "ManagedBy": "CloudFormation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": null}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 20, "failed": 1, "skipped": 0, "parsing_errors": 0, "resource_count": 55, "checkov_version": "3.2.390"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}