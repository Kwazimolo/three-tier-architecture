{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_AWS_17", "bc_check_id": "BC_AWS_PUBLIC_2", "check_name": "Ensure all data stored in RDS is not publicly accessible", "check_result": {"result": "PASSED", "evaluated_keys": ["publicly_accessible"]}, "code_block": [[16, "resource \"aws_db_instance\" \"data_tier_db\" {\n"], [17, "  count                      = 2\n"], [18, "  identifier                 = \"ot-data-tier-db-${count.index + 1}\"\n"], [19, "  allocated_storage          = 10\n"], [20, "  db_name                    = \"data_tier_db\"\n"], [21, "  engine                     = \"mysql\"\n"], [22, "  engine_version             = \"8.0.32\"\n"], [23, "  instance_class             = \"db.t3.micro\"\n"], [24, "  username                   = \"admin\"\n"], [25, "  manage_master_user_password = true\n"], [26, "  db_subnet_group_name       = aws_db_subnet_group.data_tier_subnet_group.name\n"], [27, "  vpc_security_group_ids     = [var.security_group_ids.db]\n"], [28, "  multi_az                   = false\n"], [29, "  publicly_accessible        = false\n"], [30, "  skip_final_snapshot        = true\n"], [31, "  \n"], [32, "  tags = {\n"], [33, "    Name        = \"OT-Data-Tier-DB-${count.index + 1}\"\n"], [34, "    Environment = \"Production\"\n"], [35, "    Tier        = \"Data\"\n"], [36, "    ManagedBy   = \"OpenTofu\"\n"], [37, "    Role        = \"MySQL-Database\"\n"], [38, "    Replica     = count.index == 0 ? \"Primary\" : \"Secondary\"\n"], [39, "  }\n"], [40, "}"]], "file_path": "/modules/database/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/database/main.tf", "file_line_range": [16, 40], "resource": "module.database.aws_db_instance.data_tier_db[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSPubliclyAccessible", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-Data-Tier-DB-${0 + 1}", "Replica": "Primary", "Role": "MySQL-Database", "Tier": "Data"}, "caller_file_path": "/main.tf", "caller_file_line_range": [47, 57], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-2", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "breadcrumbs": {"vpc_security_group_ids": [{"type": "module", "name": "database", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "security_group_ids", "path": "/github/workspace/infrastructure/opentofu/modules/database/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "resource", "name": "aws_db_subnet_group.data_tier_subnet_group", "path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "database", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 5, "source_module_object": null}]}}, {"check_id": "CKV_AWS_17", "bc_check_id": "BC_AWS_PUBLIC_2", "check_name": "Ensure all data stored in RDS is not publicly accessible", "check_result": {"result": "PASSED", "evaluated_keys": ["publicly_accessible"]}, "code_block": [[16, "resource \"aws_db_instance\" \"data_tier_db\" {\n"], [17, "  count                      = 2\n"], [18, "  identifier                 = \"ot-data-tier-db-${count.index + 1}\"\n"], [19, "  allocated_storage          = 10\n"], [20, "  db_name                    = \"data_tier_db\"\n"], [21, "  engine                     = \"mysql\"\n"], [22, "  engine_version             = \"8.0.32\"\n"], [23, "  instance_class             = \"db.t3.micro\"\n"], [24, "  username                   = \"admin\"\n"], [25, "  manage_master_user_password = true\n"], [26, "  db_subnet_group_name       = aws_db_subnet_group.data_tier_subnet_group.name\n"], [27, "  vpc_security_group_ids     = [var.security_group_ids.db]\n"], [28, "  multi_az                   = false\n"], [29, "  publicly_accessible        = false\n"], [30, "  skip_final_snapshot        = true\n"], [31, "  \n"], [32, "  tags = {\n"], [33, "    Name        = \"OT-Data-Tier-DB-${count.index + 1}\"\n"], [34, "    Environment = \"Production\"\n"], [35, "    Tier        = \"Data\"\n"], [36, "    ManagedBy   = \"OpenTofu\"\n"], [37, "    Role        = \"MySQL-Database\"\n"], [38, "    Replica     = count.index == 0 ? \"Primary\" : \"Secondary\"\n"], [39, "  }\n"], [40, "}"]], "file_path": "/modules/database/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/database/main.tf", "file_line_range": [16, 40], "resource": "module.database.aws_db_instance.data_tier_db[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSPubliclyAccessible", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-Data-Tier-DB-${1 + 1}", "Replica": "Secondary", "Role": "MySQL-Database", "Tier": "Data"}, "caller_file_path": "/main.tf", "caller_file_line_range": [47, 57], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-2", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "breadcrumbs": {"vpc_security_group_ids": [{"type": "module", "name": "database", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "security_group_ids", "path": "/github/workspace/infrastructure/opentofu/modules/database/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "resource", "name": "aws_db_subnet_group.data_tier_subnet_group", "path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "database", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 5, "source_module_object": null}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[7, "resource \"aws_security_group\" \"bastion_sg\" {\n"], [8, "  name        = \"OT-bastion_sg\"\n"], [9, "  description = \"Security group for Bastion Host on the presentation tier\"\n"], [10, "  vpc_id      = var.vpc_id\n"], [11, "\n"], [12, "  ingress {\n"], [13, "    description = \"SSH into the instance\"\n"], [14, "    from_port   = 22\n"], [15, "    to_port     = 22\n"], [16, "    protocol    = \"tcp\"\n"], [17, "    cidr_blocks = [\"209.35.86.151/32\"]\n"], [18, "  }\n"], [19, "\n"], [20, "  egress {\n"], [21, "    description = \"Allow Outbound connectivity\"\n"], [22, "    from_port   = 0\n"], [23, "    to_port     = 0\n"], [24, "    protocol    = \"-1\"\n"], [25, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [26, "  }\n"], [27, "\n"], [28, "  tags = {\n"], [29, "    Name        = \"OT-bastion_sg\"\n"], [30, "    Environment = \"Production\"\n"], [31, "    Tier        = \"Presentation\"\n"], [32, "    ManagedBy   = \"OpenTofu\"\n"], [33, "    Role        = \"Bastion\"\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [7, 35], "resource": "module.security.aws_security_group.bastion_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-bastion_sg", "Role": "Bastion", "Tier": "Presentation"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[7, "resource \"aws_security_group\" \"bastion_sg\" {\n"], [8, "  name        = \"OT-bastion_sg\"\n"], [9, "  description = \"Security group for Bastion Host on the presentation tier\"\n"], [10, "  vpc_id      = var.vpc_id\n"], [11, "\n"], [12, "  ingress {\n"], [13, "    description = \"SSH into the instance\"\n"], [14, "    from_port   = 22\n"], [15, "    to_port     = 22\n"], [16, "    protocol    = \"tcp\"\n"], [17, "    cidr_blocks = [\"209.35.86.151/32\"]\n"], [18, "  }\n"], [19, "\n"], [20, "  egress {\n"], [21, "    description = \"Allow Outbound connectivity\"\n"], [22, "    from_port   = 0\n"], [23, "    to_port     = 0\n"], [24, "    protocol    = \"-1\"\n"], [25, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [26, "  }\n"], [27, "\n"], [28, "  tags = {\n"], [29, "    Name        = \"OT-bastion_sg\"\n"], [30, "    Environment = \"Production\"\n"], [31, "    Tier        = \"Presentation\"\n"], [32, "    ManagedBy   = \"OpenTofu\"\n"], [33, "    Role        = \"Bastion\"\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [7, 35], "resource": "module.security.aws_security_group.bastion_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-bastion_sg", "Role": "Bastion", "Tier": "Presentation"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["description"]}, "code_block": [[7, "resource \"aws_security_group\" \"bastion_sg\" {\n"], [8, "  name        = \"OT-bastion_sg\"\n"], [9, "  description = \"Security group for Bastion Host on the presentation tier\"\n"], [10, "  vpc_id      = var.vpc_id\n"], [11, "\n"], [12, "  ingress {\n"], [13, "    description = \"SSH into the instance\"\n"], [14, "    from_port   = 22\n"], [15, "    to_port     = 22\n"], [16, "    protocol    = \"tcp\"\n"], [17, "    cidr_blocks = [\"209.35.86.151/32\"]\n"], [18, "  }\n"], [19, "\n"], [20, "  egress {\n"], [21, "    description = \"Allow Outbound connectivity\"\n"], [22, "    from_port   = 0\n"], [23, "    to_port     = 0\n"], [24, "    protocol    = \"-1\"\n"], [25, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [26, "  }\n"], [27, "\n"], [28, "  tags = {\n"], [29, "    Name        = \"OT-bastion_sg\"\n"], [30, "    Environment = \"Production\"\n"], [31, "    Tier        = \"Presentation\"\n"], [32, "    ManagedBy   = \"OpenTofu\"\n"], [33, "    Role        = \"Bastion\"\n"], [34, "  }\n"], [35, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [7, 35], "resource": "module.security.aws_security_group.bastion_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-bastion_sg", "Role": "Bastion", "Tier": "Presentation"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[39, "resource \"aws_security_group\" \"app_sg\" {\n"], [40, "  name        = \"OT-app-sg\"\n"], [41, "  description = \"Security group for application servers on the application tier\"\n"], [42, "  vpc_id      = var.vpc_id\n"], [43, "\n"], [44, "  ingress {\n"], [45, "    description     = \"SSH into the instance from bastion host\"\n"], [46, "    from_port       = 22\n"], [47, "    to_port         = 22\n"], [48, "    protocol        = \"tcp\"\n"], [49, "    security_groups = [aws_security_group.bastion_sg.id]\n"], [50, "  }\n"], [51, "\n"], [52, "  ingress {\n"], [53, "    description     = \"Allow connectivity from ALB\"\n"], [54, "    from_port       = 80\n"], [55, "    to_port         = 80\n"], [56, "    protocol        = \"tcp\"\n"], [57, "    security_groups = [aws_security_group.alb_sg.id]\n"], [58, "  }\n"], [59, "\n"], [60, "  egress {\n"], [61, "    description = \"Allow Outbound connectivity\"\n"], [62, "    from_port   = 0\n"], [63, "    to_port     = 0\n"], [64, "    protocol    = \"-1\"\n"], [65, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [66, "  }\n"], [67, "\n"], [68, "  tags = {\n"], [69, "    Name        = \"OT-app-sg\"\n"], [70, "    Environment = \"Production\"\n"], [71, "    Tier        = \"Application\"\n"], [72, "    ManagedBy   = \"OpenTofu\"\n"], [73, "    Role        = \"WebServer\"\n"], [74, "  }\n"], [75, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [39, 75], "resource": "module.security.aws_security_group.app_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-app-sg", "Role": "WebServer", "Tier": "Application"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[39, "resource \"aws_security_group\" \"app_sg\" {\n"], [40, "  name        = \"OT-app-sg\"\n"], [41, "  description = \"Security group for application servers on the application tier\"\n"], [42, "  vpc_id      = var.vpc_id\n"], [43, "\n"], [44, "  ingress {\n"], [45, "    description     = \"SSH into the instance from bastion host\"\n"], [46, "    from_port       = 22\n"], [47, "    to_port         = 22\n"], [48, "    protocol        = \"tcp\"\n"], [49, "    security_groups = [aws_security_group.bastion_sg.id]\n"], [50, "  }\n"], [51, "\n"], [52, "  ingress {\n"], [53, "    description     = \"Allow connectivity from ALB\"\n"], [54, "    from_port       = 80\n"], [55, "    to_port         = 80\n"], [56, "    protocol        = \"tcp\"\n"], [57, "    security_groups = [aws_security_group.alb_sg.id]\n"], [58, "  }\n"], [59, "\n"], [60, "  egress {\n"], [61, "    description = \"Allow Outbound connectivity\"\n"], [62, "    from_port   = 0\n"], [63, "    to_port     = 0\n"], [64, "    protocol    = \"-1\"\n"], [65, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [66, "  }\n"], [67, "\n"], [68, "  tags = {\n"], [69, "    Name        = \"OT-app-sg\"\n"], [70, "    Environment = \"Production\"\n"], [71, "    Tier        = \"Application\"\n"], [72, "    ManagedBy   = \"OpenTofu\"\n"], [73, "    Role        = \"WebServer\"\n"], [74, "  }\n"], [75, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [39, 75], "resource": "module.security.aws_security_group.app_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-app-sg", "Role": "WebServer", "Tier": "Application"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["description"]}, "code_block": [[39, "resource \"aws_security_group\" \"app_sg\" {\n"], [40, "  name        = \"OT-app-sg\"\n"], [41, "  description = \"Security group for application servers on the application tier\"\n"], [42, "  vpc_id      = var.vpc_id\n"], [43, "\n"], [44, "  ingress {\n"], [45, "    description     = \"SSH into the instance from bastion host\"\n"], [46, "    from_port       = 22\n"], [47, "    to_port         = 22\n"], [48, "    protocol        = \"tcp\"\n"], [49, "    security_groups = [aws_security_group.bastion_sg.id]\n"], [50, "  }\n"], [51, "\n"], [52, "  ingress {\n"], [53, "    description     = \"Allow connectivity from ALB\"\n"], [54, "    from_port       = 80\n"], [55, "    to_port         = 80\n"], [56, "    protocol        = \"tcp\"\n"], [57, "    security_groups = [aws_security_group.alb_sg.id]\n"], [58, "  }\n"], [59, "\n"], [60, "  egress {\n"], [61, "    description = \"Allow Outbound connectivity\"\n"], [62, "    from_port   = 0\n"], [63, "    to_port     = 0\n"], [64, "    protocol    = \"-1\"\n"], [65, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [66, "  }\n"], [67, "\n"], [68, "  tags = {\n"], [69, "    Name        = \"OT-app-sg\"\n"], [70, "    Environment = \"Production\"\n"], [71, "    Tier        = \"Application\"\n"], [72, "    ManagedBy   = \"OpenTofu\"\n"], [73, "    Role        = \"WebServer\"\n"], [74, "  }\n"], [75, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [39, 75], "resource": "module.security.aws_security_group.app_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-app-sg", "Role": "WebServer", "Tier": "Application"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[79, "resource \"aws_security_group\" \"alb_sg\" {\n"], [80, "  name        = \"OT-alb-sg\"\n"], [81, "  description = \"Security group for load balancer on the web tier\"\n"], [82, "  vpc_id      = var.vpc_id\n"], [83, "\n"], [84, "  ingress {\n"], [85, "    description = \"Access to webpage\"\n"], [86, "    from_port   = 80\n"], [87, "    to_port     = 80\n"], [88, "    protocol    = \"tcp\"\n"], [89, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  egress {\n"], [93, "    description = \"Allow all Outbound connectivity\"\n"], [94, "    from_port   = 0\n"], [95, "    to_port     = 0\n"], [96, "    protocol    = \"-1\"\n"], [97, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [98, "  }\n"], [99, "\n"], [100, "  tags = {\n"], [101, "    Name        = \"OT-alb-sg\"\n"], [102, "    Environment = \"Production\"\n"], [103, "    Tier        = \"Web\"\n"], [104, "    ManagedBy   = \"OpenTofu\"\n"], [105, "    Role        = \"LoadBalancer\"\n"], [106, "  }\n"], [107, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [79, 107], "resource": "module.security.aws_security_group.alb_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-alb-sg", "Role": "LoadBalancer", "Tier": "Web"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[79, "resource \"aws_security_group\" \"alb_sg\" {\n"], [80, "  name        = \"OT-alb-sg\"\n"], [81, "  description = \"Security group for load balancer on the web tier\"\n"], [82, "  vpc_id      = var.vpc_id\n"], [83, "\n"], [84, "  ingress {\n"], [85, "    description = \"Access to webpage\"\n"], [86, "    from_port   = 80\n"], [87, "    to_port     = 80\n"], [88, "    protocol    = \"tcp\"\n"], [89, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  egress {\n"], [93, "    description = \"Allow all Outbound connectivity\"\n"], [94, "    from_port   = 0\n"], [95, "    to_port     = 0\n"], [96, "    protocol    = \"-1\"\n"], [97, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [98, "  }\n"], [99, "\n"], [100, "  tags = {\n"], [101, "    Name        = \"OT-alb-sg\"\n"], [102, "    Environment = \"Production\"\n"], [103, "    Tier        = \"Web\"\n"], [104, "    ManagedBy   = \"OpenTofu\"\n"], [105, "    Role        = \"LoadBalancer\"\n"], [106, "  }\n"], [107, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [79, 107], "resource": "module.security.aws_security_group.alb_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-alb-sg", "Role": "LoadBalancer", "Tier": "Web"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["description"]}, "code_block": [[79, "resource \"aws_security_group\" \"alb_sg\" {\n"], [80, "  name        = \"OT-alb-sg\"\n"], [81, "  description = \"Security group for load balancer on the web tier\"\n"], [82, "  vpc_id      = var.vpc_id\n"], [83, "\n"], [84, "  ingress {\n"], [85, "    description = \"Access to webpage\"\n"], [86, "    from_port   = 80\n"], [87, "    to_port     = 80\n"], [88, "    protocol    = \"tcp\"\n"], [89, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  egress {\n"], [93, "    description = \"Allow all Outbound connectivity\"\n"], [94, "    from_port   = 0\n"], [95, "    to_port     = 0\n"], [96, "    protocol    = \"-1\"\n"], [97, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [98, "  }\n"], [99, "\n"], [100, "  tags = {\n"], [101, "    Name        = \"OT-alb-sg\"\n"], [102, "    Environment = \"Production\"\n"], [103, "    Tier        = \"Web\"\n"], [104, "    ManagedBy   = \"OpenTofu\"\n"], [105, "    Role        = \"LoadBalancer\"\n"], [106, "  }\n"], [107, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [79, 107], "resource": "module.security.aws_security_group.alb_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-alb-sg", "Role": "LoadBalancer", "Tier": "Web"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[111, "resource \"aws_security_group\" \"db_sg\" {\n"], [112, "  name        = \"OT-db-sg\"\n"], [113, "  description = \"Allow application tier to communicate to database tier\"\n"], [114, "  vpc_id      = var.vpc_id\n"], [115, "\n"], [116, "  ingress {\n"], [117, "    description     = \"Allow connection to database\"\n"], [118, "    from_port       = 3306\n"], [119, "    to_port         = 3306\n"], [120, "    protocol        = \"tcp\"\n"], [121, "    security_groups = [aws_security_group.app_sg.id]\n"], [122, "  }\n"], [123, "\n"], [124, "  tags = {\n"], [125, "    Name        = \"OT-db-sg\"\n"], [126, "    Environment = \"Production\"\n"], [127, "    Tier        = \"Data\"\n"], [128, "    ManagedBy   = \"OpenTofu\"\n"], [129, "    Role        = \"Database\"\n"], [130, "  }\n"], [131, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [111, 131], "resource": "module.security.aws_security_group.db_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-db-sg", "Role": "Database", "Tier": "Data"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[111, "resource \"aws_security_group\" \"db_sg\" {\n"], [112, "  name        = \"OT-db-sg\"\n"], [113, "  description = \"Allow application tier to communicate to database tier\"\n"], [114, "  vpc_id      = var.vpc_id\n"], [115, "\n"], [116, "  ingress {\n"], [117, "    description     = \"Allow connection to database\"\n"], [118, "    from_port       = 3306\n"], [119, "    to_port         = 3306\n"], [120, "    protocol        = \"tcp\"\n"], [121, "    security_groups = [aws_security_group.app_sg.id]\n"], [122, "  }\n"], [123, "\n"], [124, "  tags = {\n"], [125, "    Name        = \"OT-db-sg\"\n"], [126, "    Environment = \"Production\"\n"], [127, "    Tier        = \"Data\"\n"], [128, "    ManagedBy   = \"OpenTofu\"\n"], [129, "    Role        = \"Database\"\n"], [130, "  }\n"], [131, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [111, 131], "resource": "module.security.aws_security_group.db_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-db-sg", "Role": "Database", "Tier": "Data"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["description"]}, "code_block": [[111, "resource \"aws_security_group\" \"db_sg\" {\n"], [112, "  name        = \"OT-db-sg\"\n"], [113, "  description = \"Allow application tier to communicate to database tier\"\n"], [114, "  vpc_id      = var.vpc_id\n"], [115, "\n"], [116, "  ingress {\n"], [117, "    description     = \"Allow connection to database\"\n"], [118, "    from_port       = 3306\n"], [119, "    to_port         = 3306\n"], [120, "    protocol        = \"tcp\"\n"], [121, "    security_groups = [aws_security_group.app_sg.id]\n"], [122, "  }\n"], [123, "\n"], [124, "  tags = {\n"], [125, "    Name        = \"OT-db-sg\"\n"], [126, "    Environment = \"Production\"\n"], [127, "    Tier        = \"Data\"\n"], [128, "    ManagedBy   = \"OpenTofu\"\n"], [129, "    Role        = \"Database\"\n"], [130, "  }\n"], [131, "}\n"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [111, 131], "resource": "module.security.aws_security_group.db_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-db-sg", "Role": "Database", "Tier": "Data"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[133, "resource \"aws_security_group\" \"vpc_endpoints_sg\" {\n"], [134, "  name        = \"OT-vpce-sg\"\n"], [135, "  description = \"Security group for VPC endpoints\"\n"], [136, "  vpc_id      = var.vpc_id\n"], [137, "\n"], [138, "  ingress {\n"], [139, "    from_port       = 443\n"], [140, "    to_port         = 443\n"], [141, "    protocol        = \"tcp\"\n"], [142, "    security_groups = [aws_security_group.app_sg.id]\n"], [143, "    description     = \"Allow HTTPS from EC2 instances\"\n"], [144, "  }\n"], [145, "\n"], [146, "  tags = {\n"], [147, "    Name        = \"OT-vnet-sg\"\n"], [148, "    Environment = \"Production\"\n"], [149, "    Tier        = \"Network\"\n"], [150, "    ManagedBy   = \"OpenTofu\"\n"], [151, "    Role        = \"VPCEndpoint\"\n"], [152, "  }\n"], [153, "}"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [133, 153], "resource": "module.security.aws_security_group.vpc_endpoints_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-vnet-sg", "Role": "VPCEndpoint", "Tier": "Network"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[133, "resource \"aws_security_group\" \"vpc_endpoints_sg\" {\n"], [134, "  name        = \"OT-vpce-sg\"\n"], [135, "  description = \"Security group for VPC endpoints\"\n"], [136, "  vpc_id      = var.vpc_id\n"], [137, "\n"], [138, "  ingress {\n"], [139, "    from_port       = 443\n"], [140, "    to_port         = 443\n"], [141, "    protocol        = \"tcp\"\n"], [142, "    security_groups = [aws_security_group.app_sg.id]\n"], [143, "    description     = \"Allow HTTPS from EC2 instances\"\n"], [144, "  }\n"], [145, "\n"], [146, "  tags = {\n"], [147, "    Name        = \"OT-vnet-sg\"\n"], [148, "    Environment = \"Production\"\n"], [149, "    Tier        = \"Network\"\n"], [150, "    ManagedBy   = \"OpenTofu\"\n"], [151, "    Role        = \"VPCEndpoint\"\n"], [152, "  }\n"], [153, "}"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [133, 153], "resource": "module.security.aws_security_group.vpc_endpoints_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-vnet-sg", "Role": "VPCEndpoint", "Tier": "Network"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["description"]}, "code_block": [[133, "resource \"aws_security_group\" \"vpc_endpoints_sg\" {\n"], [134, "  name        = \"OT-vpce-sg\"\n"], [135, "  description = \"Security group for VPC endpoints\"\n"], [136, "  vpc_id      = var.vpc_id\n"], [137, "\n"], [138, "  ingress {\n"], [139, "    from_port       = 443\n"], [140, "    to_port         = 443\n"], [141, "    protocol        = \"tcp\"\n"], [142, "    security_groups = [aws_security_group.app_sg.id]\n"], [143, "    description     = \"Allow HTTPS from EC2 instances\"\n"], [144, "  }\n"], [145, "\n"], [146, "  tags = {\n"], [147, "    Name        = \"OT-vnet-sg\"\n"], [148, "    Environment = \"Production\"\n"], [149, "    Tier        = \"Network\"\n"], [150, "    ManagedBy   = \"OpenTofu\"\n"], [151, "    Role        = \"VPCEndpoint\"\n"], [152, "  }\n"], [153, "}"]], "file_path": "/modules/security/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/security/main.tf", "file_line_range": [133, 153], "resource": "module.security.aws_security_group.vpc_endpoints_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-vnet-sg", "Role": "VPCEndpoint", "Tier": "Network"}, "caller_file_path": "/main.tf", "caller_file_line_range": [5, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/security/main.tf", "breadcrumbs": {"vpc_id": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/github/workspace/infrastructure/opentofu/modules/security/variable.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "security", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 2, "source_module_object": null}]}}], "failed_checks": [{"check_id": "CKV_AWS_8", "bc_check_id": "BC_AWS_GENERAL_13", "check_name": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["root_block_device"]}, "code_block": [[6, "resource \"aws_instance\" \"app_tier_ec2\" {\n"], [7, "  count                  = 2\n"], [8, "  ami                    = \"ami-0fed63ea358539e44\"\n"], [9, "  instance_type          = \"t2.micro\"\n"], [10, "  key_name               = \"ot_dissertation_key\"\n"], [11, "  subnet_id              = var.app_subnet_ids.app[count.index]\n"], [12, "  vpc_security_group_ids = [var.security_group_ids.app]\n"], [13, "  user_data              = file(\"${path.module}/services.sh\")\n"], [14, "\n"], [15, "  tags = {\n"], [16, "    Name        = \"OT-app-instance-${count.index + 1}\"\n"], [17, "    AZ          = \"az${count.index + 1}\"\n"], [18, "    Environment = \"Production\"\n"], [19, "    ManagedBy   = \"OpenTofu\"\n"], [20, "    Tier        = \"Application\"\n"], [21, "    Role        = \"WebServer\"\n"], [22, "    Project     = \"3TierArchitecture\"\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "/modules/compute/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/compute/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/compute/main.tf", "file_line_range": [6, 24], "resource": "module.compute.aws_instance.app_tier_ec2[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption", "fixed_definition": null, "entity_tags": {"AZ": "az${0 + 1}", "Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-app-instance-${0 + 1}", "Project": "3TierArchitecture", "Role": "WebServer", "Tier": "Application"}, "caller_file_path": "/main.tf", "caller_file_line_range": [13, 28], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/compute/main.tf", "breadcrumbs": {"subnet_id": [{"type": "module", "name": "compute", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "app_subnet_ids", "path": "/github/workspace/infrastructure/opentofu/modules/compute/variables.tf", "module_connection": false}], "vpc_security_group_ids": [{"type": "module", "name": "compute", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "security_group_ids", "path": "/github/workspace/infrastructure/opentofu/modules/compute/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "compute", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 3, "source_module_object": null}]}}, {"check_id": "CKV_AWS_8", "bc_check_id": "BC_AWS_GENERAL_13", "check_name": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["root_block_device"]}, "code_block": [[26, "resource \"aws_instance\" \"bastion_ec2\" {\n"], [27, "  count                       = 1\n"], [28, "  ami                         = \"ami-0fed63ea358539e44\"\n"], [29, "  instance_type               = \"t2.micro\"\n"], [30, "  key_name                    = \"ot_dissertation_key\"\n"], [31, "  subnet_id                   = var.app_subnet_ids.bastion[0]\n"], [32, "  associate_public_ip_address = true\n"], [33, "  vpc_security_group_ids      = [var.security_group_ids.bastion]\n"], [34, "\n"], [35, "  tags = {\n"], [36, "    Name        = \"OT-bastion-instance-${count.index + 1}\"\n"], [37, "    AZ          = \"az${count.index + 1}\"\n"], [38, "    Environment = \"Production\"\n"], [39, "    ManagedBy   = \"OpenTofu\"\n"], [40, "    Tier        = \"Presentation\"\n"], [41, "    Role        = \"BastionHost\"\n"], [42, "    Project     = \"3TierArchitecture\"\n"], [43, "  }\n"], [44, "}"]], "file_path": "/modules/compute/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/compute/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/compute/main.tf", "file_line_range": [26, 44], "resource": "module.compute.aws_instance.bastion_ec2[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption", "fixed_definition": null, "entity_tags": {"AZ": "az${0 + 1}", "Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-bastion-instance-${0 + 1}", "Project": "3TierArchitecture", "Role": "BastionHost", "Tier": "Presentation"}, "caller_file_path": "/main.tf", "caller_file_line_range": [13, 28], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/compute/main.tf", "breadcrumbs": {"subnet_id": [{"type": "module", "name": "compute", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "app_subnet_ids", "path": "/github/workspace/infrastructure/opentofu/modules/compute/variables.tf", "module_connection": false}], "vpc_security_group_ids": [{"type": "module", "name": "compute", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "security_group_ids", "path": "/github/workspace/infrastructure/opentofu/modules/compute/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "compute", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 3, "source_module_object": null}]}}, {"check_id": "CKV_AWS_8", "bc_check_id": "BC_AWS_GENERAL_13", "check_name": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["root_block_device"]}, "code_block": [[6, "resource \"aws_instance\" \"app_tier_ec2\" {\n"], [7, "  count                  = 2\n"], [8, "  ami                    = \"ami-0fed63ea358539e44\"\n"], [9, "  instance_type          = \"t2.micro\"\n"], [10, "  key_name               = \"ot_dissertation_key\"\n"], [11, "  subnet_id              = var.app_subnet_ids.app[count.index]\n"], [12, "  vpc_security_group_ids = [var.security_group_ids.app]\n"], [13, "  user_data              = file(\"${path.module}/services.sh\")\n"], [14, "\n"], [15, "  tags = {\n"], [16, "    Name        = \"OT-app-instance-${count.index + 1}\"\n"], [17, "    AZ          = \"az${count.index + 1}\"\n"], [18, "    Environment = \"Production\"\n"], [19, "    ManagedBy   = \"OpenTofu\"\n"], [20, "    Tier        = \"Application\"\n"], [21, "    Role        = \"WebServer\"\n"], [22, "    Project     = \"3TierArchitecture\"\n"], [23, "  }\n"], [24, "}\n"]], "file_path": "/modules/compute/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/compute/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/compute/main.tf", "file_line_range": [6, 24], "resource": "module.compute.aws_instance.app_tier_ec2[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption", "fixed_definition": null, "entity_tags": {"AZ": "az${1 + 1}", "Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-app-instance-${1 + 1}", "Project": "3TierArchitecture", "Role": "WebServer", "Tier": "Application"}, "caller_file_path": "/main.tf", "caller_file_line_range": [13, 28], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/compute/main.tf", "breadcrumbs": {"subnet_id": [{"type": "module", "name": "compute", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "app_subnet_ids", "path": "/github/workspace/infrastructure/opentofu/modules/compute/variables.tf", "module_connection": false}], "vpc_security_group_ids": [{"type": "module", "name": "compute", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "security_group_ids", "path": "/github/workspace/infrastructure/opentofu/modules/compute/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "compute", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 3, "source_module_object": null}]}}, {"check_id": "CKV_AWS_16", "bc_check_id": "BC_AWS_GENERAL_4", "check_name": "Ensure all data stored in the RDS is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[16, "resource \"aws_db_instance\" \"data_tier_db\" {\n"], [17, "  count                      = 2\n"], [18, "  identifier                 = \"ot-data-tier-db-${count.index + 1}\"\n"], [19, "  allocated_storage          = 10\n"], [20, "  db_name                    = \"data_tier_db\"\n"], [21, "  engine                     = \"mysql\"\n"], [22, "  engine_version             = \"8.0.32\"\n"], [23, "  instance_class             = \"db.t3.micro\"\n"], [24, "  username                   = \"admin\"\n"], [25, "  manage_master_user_password = true\n"], [26, "  db_subnet_group_name       = aws_db_subnet_group.data_tier_subnet_group.name\n"], [27, "  vpc_security_group_ids     = [var.security_group_ids.db]\n"], [28, "  multi_az                   = false\n"], [29, "  publicly_accessible        = false\n"], [30, "  skip_final_snapshot        = true\n"], [31, "  \n"], [32, "  tags = {\n"], [33, "    Name        = \"OT-Data-Tier-DB-${count.index + 1}\"\n"], [34, "    Environment = \"Production\"\n"], [35, "    Tier        = \"Data\"\n"], [36, "    ManagedBy   = \"OpenTofu\"\n"], [37, "    Role        = \"MySQL-Database\"\n"], [38, "    Replica     = count.index == 0 ? \"Primary\" : \"Secondary\"\n"], [39, "  }\n"], [40, "}"]], "file_path": "/modules/database/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/database/main.tf", "file_line_range": [16, 40], "resource": "module.database.aws_db_instance.data_tier_db[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSEncryption", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-Data-Tier-DB-${0 + 1}", "Replica": "Primary", "Role": "MySQL-Database", "Tier": "Data"}, "caller_file_path": "/main.tf", "caller_file_line_range": [47, 57], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "breadcrumbs": {"vpc_security_group_ids": [{"type": "module", "name": "database", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "security_group_ids", "path": "/github/workspace/infrastructure/opentofu/modules/database/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "resource", "name": "aws_db_subnet_group.data_tier_subnet_group", "path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "database", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 5, "source_module_object": null}]}}, {"check_id": "CKV_AWS_16", "bc_check_id": "BC_AWS_GENERAL_4", "check_name": "Ensure all data stored in the RDS is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[16, "resource \"aws_db_instance\" \"data_tier_db\" {\n"], [17, "  count                      = 2\n"], [18, "  identifier                 = \"ot-data-tier-db-${count.index + 1}\"\n"], [19, "  allocated_storage          = 10\n"], [20, "  db_name                    = \"data_tier_db\"\n"], [21, "  engine                     = \"mysql\"\n"], [22, "  engine_version             = \"8.0.32\"\n"], [23, "  instance_class             = \"db.t3.micro\"\n"], [24, "  username                   = \"admin\"\n"], [25, "  manage_master_user_password = true\n"], [26, "  db_subnet_group_name       = aws_db_subnet_group.data_tier_subnet_group.name\n"], [27, "  vpc_security_group_ids     = [var.security_group_ids.db]\n"], [28, "  multi_az                   = false\n"], [29, "  publicly_accessible        = false\n"], [30, "  skip_final_snapshot        = true\n"], [31, "  \n"], [32, "  tags = {\n"], [33, "    Name        = \"OT-Data-Tier-DB-${count.index + 1}\"\n"], [34, "    Environment = \"Production\"\n"], [35, "    Tier        = \"Data\"\n"], [36, "    ManagedBy   = \"OpenTofu\"\n"], [37, "    Role        = \"MySQL-Database\"\n"], [38, "    Replica     = count.index == 0 ? \"Primary\" : \"Secondary\"\n"], [39, "  }\n"], [40, "}"]], "file_path": "/modules/database/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/database/main.tf", "file_line_range": [16, 40], "resource": "module.database.aws_db_instance.data_tier_db[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSEncryption", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-Data-Tier-DB-${1 + 1}", "Replica": "Secondary", "Role": "MySQL-Database", "Tier": "Data"}, "caller_file_path": "/main.tf", "caller_file_line_range": [47, 57], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "breadcrumbs": {"vpc_security_group_ids": [{"type": "module", "name": "database", "path": "/github/workspace/infrastructure/opentofu/main.tf", "module_connection": false}, {"type": "variable", "name": "security_group_ids", "path": "/github/workspace/infrastructure/opentofu/modules/database/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "resource", "name": "aws_db_subnet_group.data_tier_subnet_group", "path": "/github/workspace/infrastructure/opentofu/modules/database/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "database", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 5, "source_module_object": null}]}}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "FAILED", "evaluated_keys": ["protocol"]}, "code_block": [[53, "resource \"aws_lb_listener\" \"app_listener\" {\n"], [54, "  load_balancer_arn = aws_lb.app_alb.arn\n"], [55, "  port              = \"80\"\n"], [56, "  protocol          = \"HTTP\"\n"], [57, "  \n"], [58, "  default_action {\n"], [59, "    type             = \"forward\"\n"], [60, "    target_group_arn = aws_lb_target_group.app_lb_tg.arn\n"], [61, "  }\n"], [62, "  \n"], [63, "  tags = {\n"], [64, "    Name        = \"OT-App-Tier-HTTP-Listener\"\n"], [65, "    Environment = \"Production\"\n"], [66, "    Tier        = \"Web\"\n"], [67, "    ManagedBy   = \"OpenTofu\"\n"], [68, "  }\n"], [69, "}\n"]], "file_path": "/modules/load_balancer/main.tf", "file_abs_path": "/github/workspace/infrastructure/opentofu/modules/load_balancer/main.tf", "repo_file_path": "/infrastructure/opentofu/modules/load_balancer/main.tf", "file_line_range": [53, 69], "resource": "module.load_balancing.aws_lb_listener.app_listener", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": {"Environment": "Production", "ManagedBy": "OpenTofu", "Name": "OT-App-Tier-HTTP-Listener", "Tier": "Web"}, "caller_file_path": "/main.tf", "caller_file_line_range": [30, 45], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": "/github/workspace/infrastructure/opentofu/modules/load_balancer/main.tf", "breadcrumbs": {"source_module_": [{"type": "module", "name": "load_balancing", "path": "/github/workspace/infrastructure/opentofu/main.tf", "idx": 4, "source_module_object": null}]}}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 17, "failed": 6, "skipped": 0, "parsing_errors": 0, "resource_count": 38, "checkov_version": "3.2.390"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}